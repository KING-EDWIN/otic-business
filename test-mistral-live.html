<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Live Mistral AI</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        button { padding: 10px 20px; margin: 10px 0; background: #faa51a; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #040458; }
        .result { margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>ü§ñ Test Live Mistral AI</h1>
    
    <div class="test-section">
        <h3>Test 1: Direct Mistral API Call</h3>
        <button onclick="testMistralDirect()">Test Mistral API Directly</button>
        <div id="directResult" class="result"></div>
    </div>

    <div class="test-section">
        <h3>Test 2: Business Question</h3>
        <button onclick="testBusinessQuestion()">Ask: "How can I increase my sales?"</button>
        <div id="businessResult" class="result"></div>
    </div>

    <div class="test-section">
        <h3>Test 3: Sales Prediction</h3>
        <button onclick="testSalesPrediction()">Ask: "Predict my next month's revenue"</button>
        <div id="predictionResult" class="result"></div>
    </div>

    <script>
        const API_KEY = 'mETgieTfZknbjowO3SXnZScl5Ijy4fZx';

        async function testMistralDirect() {
            const resultDiv = document.getElementById('directResult');
            resultDiv.innerHTML = '<div>üîÑ Testing Mistral API...</div>';
            
            try {
                const response = await fetch('https://api.mistral.ai/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'mistral-tiny',
                        messages: [
                            {
                                role: 'user',
                                content: 'Hello! Are you working? Respond with just "Yes, I am working!"'
                            }
                        ],
                        max_tokens: 50
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const message = data.choices[0]?.message?.content || 'No response';
                    resultDiv.innerHTML = `<div class="success">‚úÖ Mistral API Working!<br><strong>Response:</strong> "${message}"</div>`;
                } else {
                    const error = await response.text();
                    resultDiv.innerHTML = `<div class="error">‚ùå API Error: ${response.status} - ${error}</div>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">‚ùå Network Error: ${error.message}</div>`;
            }
        }

        async function testBusinessQuestion() {
            const resultDiv = document.getElementById('businessResult');
            resultDiv.innerHTML = '<div>üîÑ Asking business question...</div>';
            
            try {
                const response = await fetch('https://api.mistral.ai/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'mistral-tiny',
                        messages: [
                            {
                                role: 'system',
                                content: 'You are an AI business consultant for African SMEs. Provide practical, actionable advice.'
                            },
                            {
                                role: 'user',
                                content: 'I run a small retail store in Uganda. How can I increase my sales? Give me 3 specific strategies.'
                            }
                        ],
                        max_tokens: 200
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const message = data.choices[0]?.message?.content || 'No response';
                    resultDiv.innerHTML = `<div class="success">‚úÖ Business Advice Generated!<br><strong>Response:</strong><br>${message}</div>`;
                } else {
                    const error = await response.text();
                    resultDiv.innerHTML = `<div class="error">‚ùå API Error: ${response.status} - ${error}</div>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">‚ùå Network Error: ${error.message}</div>`;
            }
        }

        async function testSalesPrediction() {
            const resultDiv = document.getElementById('predictionResult');
            resultDiv.innerHTML = '<div>üîÑ Generating sales prediction...</div>';
            
            try {
                const response = await fetch('https://api.mistral.ai/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'mistral-tiny',
                        messages: [
                            {
                                role: 'system',
                                content: 'You are an AI business analyst. Provide data-driven predictions and insights.'
                            },
                            {
                                role: 'user',
                                content: 'Based on my current sales of UGX 1,250,000 this month, predict my next month\'s revenue. Consider seasonal factors in Uganda.'
                            }
                        ],
                        max_tokens: 150
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const message = data.choices[0]?.message?.content || 'No response';
                    resultDiv.innerHTML = `<div class="success">‚úÖ Sales Prediction Generated!<br><strong>Prediction:</strong><br>${message}</div>`;
                } else {
                    const error = await response.text();
                    resultDiv.innerHTML = `<div class="error">‚ùå API Error: ${response.status} - ${error}</div>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">‚ùå Network Error: ${error.message}</div>`;
            }
        }
    </script>
</body>
</html>

